<!DOCTYPE html>
<html>
<head>
    <title>Test Pyodide</title>
</head>
<body>
    <h1>Simple Pyodide Test</h1>
    <button id="testBtn">Test Python</button>
    <div id="output"></div>

    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <script>
        let pyodide = null;

        async function init() {
            document.getElementById('output').textContent = 'Loading Pyodide...';
            pyodide = await loadPyodide();
            await pyodide.loadPackage(['micropip']);
            const micropip = pyodide.pyimport('micropip');
            await micropip.install('openpyxl');
            document.getElementById('output').textContent = 'Ready! Click the button.';
        }

        document.getElementById('testBtn').addEventListener('click', async () => {
            const code = `
import openpyxl
print("openpyxl imported successfully!")
print("Version:", openpyxl.__version__)
"Success!"
            `;
            try {
                const result = await pyodide.runPythonAsync(code);
                document.getElementById('output').textContent = 'Result: ' + result;
            } catch (e) {
                document.getElementById('output').textContent = 'Error: ' + e.message;
            }
        });

        init();
    </script>
</body>
</html>
